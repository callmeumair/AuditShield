const i=["chat.openai.com","claude.ai","gemini.google.com","copilot.microsoft.com"];chrome.webNavigation.onCompleted.addListener(e=>{if(e.frameId!==0)return;const t=new URL(e.url).hostname;i.some(n=>t.includes(n))&&(console.log(`[AuditShield] AI Tool Usage Detected: ${t}`),chrome.storage.local.get(["audit_log"],n=>{const c=n.audit_log||[],l={timestamp:new Date().toISOString(),domain:t,url:e.url},s=[...c,l];chrome.storage.local.set({audit_log:s}),fetch("http://localhost:3000/api/ingest",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)}).then(o=>{o.ok?console.log("Event synced to AuditShield Cloud"):console.warn("Failed to sync event",o.status)}).catch(o=>console.error("Failed to sync log",o))}))},{url:[{schemes:["http","https"]}]});
